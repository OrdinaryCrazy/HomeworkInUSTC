a = [ 31, -13,  0,  0,   0, -10,  0, 0,  0;
     -13,  35, -9,  0, -11,   0,  0, 0,  0;
       0,  -9, 31,-10,   0,   0,  0, 0,  0;
       0,   0,-10, 79, -30,   0,  0, 0, -9;
       0,   0,  0,-30,  57,  -7,  0,-5,  0;
       0,   0,  0,  0,  -7,  47,-30, 0,  0;
       0,   0,  0,  0,   0, -30, 41, 0,  0;
       0,   0,  0,  0,  -5,   0,  0,27, -2;
       0,   0,  0, -9,   0,   0,  0,-2, 29
    ];
b = [-15;27;-23;0;-20;12;-7;7;10];
n = 9;
D = [ 31,  0,  0,  0,   0,   0,  0, 0,  0;
       0,  35,  0,  0,   0,   0,  0, 0,  0;
       0,   0, 31,  0,   0,   0,  0, 0,  0;
       0,   0,  0, 79,   0,   0,  0, 0,  0;
       0,   0,  0,  0,  57,   0,  0, 0,  0;
       0,   0,  0,  0,   0,  47,  0, 0,  0;
       0,   0,  0,  0,   0,   0, 41, 0,  0;
       0,   0,  0,  0,   0,   0,  0,27,  0;
       0,   0,  0,  0,   0,   0,  0, 0, 29
    ];
L = [  0,   0,  0,  0,   0,   0,  0, 0,  0;
     -13,   0,  0,  0,   0,   0,  0, 0,  0;
       0,  -9,  0,  0,   0,   0,  0, 0,  0;
       0,   0,-10,  0,   0,   0,  0, 0,  0;
       0,   0,  0,-30,   0,   0,  0, 0,  0;
       0,   0,  0,  0,  -7,   0,  0, 0,  0;
       0,   0,  0,  0,   0, -30,  0, 0,  0;
       0,   0,  0,  0,  -5,   0,  0, 0,  0;
       0,   0,  0, -9,   0,   0,  0,-2,  0
    ];
U = [  0, -13,  0,  0,   0, -10,  0, 0,  0;
       0,   0, -9,  0, -11,   0,  0, 0,  0;
       0,   0,  0,-10,   0,   0,  0, 0,  0;
       0,   0,  0,  0, -30,   0,  0, 0, -9;
       0,   0,  0,  0,   0,  -7,  0,-5,  0;
       0,   0,  0,  0,   0,   0,-30, 0,  0;
       0,   0,  0,  0,   0,   0,  0, 0,  0;
       0,   0,  0,  0,   0,   0,  0, 0, -2;
       0,   0,  0,  0,   0,   0,  0, 0,  0
    ];
%*************************************************************
for i = 1 : 99 
    w = i / 50;
    M = inv(D + w * L) * ((1 - w) * D - w * U);
    g = w * inv(D + w * L) * b;
    x0 = zeros(1,n);
    x1 = (M * x0' + g)';
    times = 1;
    while norm(x0 - x1) > 1e-7
        x0 = x1;
        times = times + 1;
        x1 = (M * x0' + g)';
    end
    fprintf("W = %d / 50 时，SOR迭代次数：%d，最终结果：\n",i,times);
    %format long
    x1
end